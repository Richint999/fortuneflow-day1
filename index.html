<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1">
<title>FortuneFlow</title><link rel=stylesheet href=styles.css></head><body>
<div class=topbar><div class="container row"><div class=brand>FortuneFlow</div>
<nav><a href=index.html>Home</a><a href=report.html>Report</a><a href=match.html>Partner Match</a><a href=pricing.html>Pricing</a><a href=account.html>Account</a></nav></div></div>
<div class=container><h1>Know Yourself</h1><div class=card>
  <h2>Four Pillars (quick input)</h2>
  <div class="grid cols-2">
    <div>
      <div class="grid cols-2">
        <div><label>Year Stem</label><select id=y-s></select></div><div><label>Year Branch</label><select id=y-b></select></div>
        <div><label>Month Stem</label><select id=m-s></select></div><div><label>Month Branch</label><select id=m-b></select></div>
        <div><label>Day Stem</label><select id=d-s></select></div><div><label>Day Branch</label><select id=d-b></select></div>
        <div><label>Hour Stem</label><select id=h-s></select></div><div><label>Hour Branch</label><select id=h-b></select></div>
      </div>
      <div style=margin-top:10px><button id=save>Calculate & Save</button> <a class=button href=report.html>Open Report</a></div>
    </div>
    <div><div id=bars class=kv></div><div id=tbl></div><div class=small>Pick stems/branches and save to browser.</div></div>
  </div>
</div>
<div class=card><h2>Extras</h2><a class=button href=match.html>Partner Match</a></div>
</div>
<script src=utils.js></script><script>
const fill=(id,arr)=>{const el=document.getElementById(id);el.innerHTML='';arr.forEach((o,i)=>{const op=document.createElement('option');op.value=i;op.textContent=o.zh;el.appendChild(op);});};
['y','m','d','h'].forEach(p=>{document.addEventListener('DOMContentLoaded',()=>{fill(p+'-s',STEMS);fill(p+'-b',BR);});});
function calc(){const g=id=>parseInt(document.getElementById(id).value,10);return total([tally(g('y-s'),g('y-b')),tally(g('m-s'),g('m-b')),tally(g('d-s'),g('d-b')),tally(g('h-s'),g('h-b'))]);}
function render(c){const bars=document.getElementById('bars');bars.innerHTML='';Object.entries(c).sort((a,b)=>b[1]-a[1]).forEach(([k,v])=>{const s=document.createElement('span');s.className='tag';s.textContent=k+': '+v;bars.appendChild(s);});}
document.addEventListener('DOMContentLoaded',()=>{document.getElementById('save').addEventListener('click',()=>{const c=calc();render(c);const least=Object.entries(c).sort((a,b)=>a[1]-b[1])[0][0];const lucky=luckyBy(least);localStorage.setItem('ff_result_en',JSON.stringify({counts:c,lucky}));alert('Saved! Go to Report.');});});
</script></body></html>
