
<!doctype html><html><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>FortuneFlow — BaZi & Five Elements</title>
<link rel="stylesheet" href="styles.css">
</head><body>

<div class="container">
  <div class="nav">
    <div class="logo">FortuneFlow</div>
    <div>
      <a href="/sandbox:/mnt/data/fortuneflow-day1/index.html">Home</a>
      <a href="/sandbox:/mnt/data/fortuneflow-day1/calc.html">Calculate</a>
      <a href="/sandbox:/mnt/data/fortuneflow-day1/pricing.html">Pricing</a>
      <a href="/sandbox:/mnt/data/fortuneflow-day1/account.html">Account</a>
      <a class="btn secondary" href="/sandbox:/mnt/data/fortuneflow-day1/checkout.html">Checkout</a>
    </div>
  </div>
</div>

<div class="container hero">
  <span class="badge">MVP Preview</span>
  <h1>Know your pattern, shape your future.</h1>
  <p>Practical BaZi insights you can act on today. Accurate charting with seasonal corrections, clear Five Elements balance, and actionable guidance.</p>
  <p>
    <a class="btn" href="/sandbox:/mnt/data/fortuneflow-day1/calc.html">Generate my BaZi — Free</a>
    <a class="btn secondary" href="/sandbox:/mnt/data/fortuneflow-day1/pricing.html">See Pricing</a>
  </p>
  <div class="kpis">
    <div class="card"><strong>Accurate</strong><br><span class="small">Seasonal corrections & hidden-stem weights</span></div>
    <div class="card"><strong>Actionable</strong><br><span class="small">Clear yearly/monthly suggestions</span></div>
    <div class="card"><strong>Privacy</strong><br><span class="small">Encrypted, delete anytime</span></div>
  </div>
  <h2>How it works</h2>
  <div class="grid">
    <div class="card"><strong>1) Enter birth data</strong><br>Gregorian/Lunar, birthplace, birth hour (estimation mode available).</div>
    <div class="card"><strong>2) Get your chart</strong><br>BaZi pillars, Day Master, Five Elements balance.</div>
    <div class="card"><strong>3) Unlock full report</strong><br>Pay to access career/love deep dive & monthly guidance.</div>
  </div>
  <h2>Sample Output</h2>
  <div class="grid">
    <div class="card">
      <strong>BaZi Chart</strong>
      <pre class="code">Year: 甲子 | Month: 丙寅 | Day: 庚午 | Hour: 壬子</pre>
    </div>
    <div class="card">
      <strong>Five Elements</strong>
      <div class="small">Metal 32% · Wood 18% · Water 20% · Fire 20% · Earth 10%</div>
    </div>
    <div class="card">
      <strong>Day Master Insight</strong>
      <div class="small">Your Day Master is Metal (庚). Focus on consistency, structure, and measurable progress.</div>
    </div>
  </div>
</div>

<div class="container footer">
  <div>© 2025 FortuneFlow · Privacy-first · Bilingual (EN/中文)</div>
</div>






<!-- Unified Auto Four Pillars (Day-2.4) -->
<section id="ff-unified" style="max-width:980px;margin:40px auto;padding:24px;border:1px solid #e5e7eb;border-radius:12px">
  <h2 style="margin:0 0 12px">Auto Four Pillars</h2>
  <p style="margin:0 10px 12px 0">Select country, date, time. We'll fill the four pillars for you. Then results will be calculated automatically.</p>
  <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center">
    <label>Country</label><select id="ff-country"></select>
    <label>Date</label><input id="ff-date" type="date">
    <label>Time</label><input id="ff-time" type="time" value="12:00">
    <input id="ff-offset" type="hidden" value="0">
    <button id="ff-autofill" style="padding:8px 12px;border:0;background:#0f172a;color:#fff;border-radius:8px;cursor:pointer">Auto-Fill</button>
  </div>
  <div id="ff-error" style="display:none;margin-top:10px;color:#b91c1c;background:#fee2e2;border:1px solid #fecaca;padding:8px;border-radius:8px"></div>
  <div id="ff-disp" style="margin-top:12px;font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;"></div>
</section>

<!-- Day-1 Interactive Demo Panel (append) -->
<section class="fortune-panel" style="max-width:980px;margin:40px auto;padding:24px;border:1px solid #eee;border-radius:12px">
  <h2 style="margin:0 0 12px">BaZi → Five Elements (Day-1 Demo)</h2>
  <p style="margin:0 0 16px">Select your four pillars (Gan-Zhi). Day-2 will auto-convert from Gregorian date/time.</p>
  <div class="grid" style="display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px">
    <!-- Year -->
    <div>
      <label>Year Stem</label>
      <select id="year-stem"></select>
      <label>Year Branch</label>
      <select id="year-branch"></select>
    </div>
    <!-- Month -->
    <div>
      <label>Month Stem</label>
      <select id="month-stem"></select>
      <label>Month Branch</label>
      <select id="month-branch"></select>
    </div>
    <!-- Day -->
    <div>
      <label>Day Stem</label>
      <select id="day-stem"></select>
      <label>Day Branch</label>
      <select id="day-branch"></select>
    </div>
    <!-- Hour -->
    <div>
      <label>Hour Stem</label>
      <select id="hour-stem"></select>
      <label>Hour Branch</label>
      <select id="hour-branch"></select>
    </div>
  </div>
  <button id="calc-btn" style="margin-top:16px;padding:10px 16px;border:0;background:#0f172a;color:#fff;border-radius:8px;cursor:pointer">Calculate</button>

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px">
    <pre id="result-json" style="background:#0b1020;color:#e6e6e6;padding:12px;border-radius:10px;overflow:auto;min-height:120px"></pre>
    <div>
      <div id="advice" style="padding:12px;border:1px dashed #ddd;border-radius:10px;min-height:120px"></div>
      <div id="five-bars" style="display:flex;align-items:flex-end;gap:10px;height:120px;margin-top:10px">
        <!-- bars injected here -->
      </div>
    </div>
  </div>
</section>
<script src="assets/js/fortune.js" defer></script>



<script >
import { populateCountrySelect, inferOffsetFromCountryAndDate } from "./assets/js/geo.js";
document.addEventListener("DOMContentLoaded", function(){
  const country = document.getElementById("d2-country");
  const dateInp = document.getElementById("d2-date");
  const off = document.getElementById("d2-off");
  populateCountrySelect("d2-country");
  function syncOffset(){ 
    const idx = parseInt(country.value || "0", 10);
    const dateStr = dateInp.value || "";
    const minutes = inferOffsetFromCountryAndDate(idx, dateStr);
    if (!isNaN(minutes)) off.value = String(minutes);
  }
  country && country.addEventListener("change", syncOffset);
  dateInp && dateInp.addEventListener("change", syncOffset);
  // Initial fill
  setTimeout(syncOffset, 0);
});
</script>


<script src="assets/js/geo.js" defer></script>
<script>
document.addEventListener("DOMContentLoaded", function(){
  var country = document.getElementById("d2-country");
  var dateInp = document.getElementById("d2-date");
  var off = document.getElementById("d2-off");
  function syncOffset(){
    try{
      var idx = parseInt((country && country.value) || "0", 10);
      var dateStr = (dateInp && dateInp.value) || "";
      var minutes = window.__FF_COUNTRY__.inferOffsetFromCountryAndDate(idx, dateStr);
      if (off && !isNaN(minutes)) off.value = String(minutes);
    }catch(e){ console.warn("UTC auto-fill error", e); }
  }
  if (window.__FF_COUNTRY__){
    window.__FF_COUNTRY__.populateCountrySelect("d2-country");
    country && country.addEventListener("change", syncOffset);
    dateInp && dateInp.addEventListener("change", syncOffset);
    setTimeout(syncOffset, 0);
  }
});
</script>


<script src="assets/js/geo.js" defer></script>
<script src="assets/js/bazi.js" defer></script>
<script src="assets/js/fortune.js" defer></script>
<script>
document.addEventListener("DOMContentLoaded", function(){
  // Populate country and hook date->offset
  if (window.__FF_COUNTRY__){
    window.__FF_COUNTRY__.populateCountrySelect("ff-country");
  }
  function syncOffset(){
    var c = document.getElementById("ff-country"), dt = document.getElementById("ff-date"), off = document.getElementById("ff-offset");
    if (!c || !dt || !off) return;
    var minutes = window.__FF_COUNTRY__ ? window.__FF_COUNTRY__.inferOffsetFromCountryAndDate(parseInt(c.value||"0",10), dt.value||"") : 0;
    if (!isNaN(minutes)) off.value = String(minutes);
  }
  document.getElementById("ff-country")?.addEventListener("change", syncOffset);
  document.getElementById("ff-date")?.addEventListener("change", syncOffset);
  setTimeout(syncOffset, 0);

  // Single Auto-Fill button
  var btn = document.getElementById("ff-autofill");
  var err = document.getElementById("ff-error");
  var disp = document.getElementById("ff-disp");
  btn && btn.addEventListener("click", function(){
    err.style.display = "none";
    var dateStr = (document.getElementById("ff-date").value||"").trim();
    var timeStr = (document.getElementById("ff-time").value||"").trim();
    var offStr  = (document.getElementById("ff-offset").value||"0").trim();
    if (!dateStr){
      err.textContent = "Please select your birth date."; err.style.display="block"; return;
    }
    try{
      var pillars = autoFourPillarsFromInput(dateStr, timeStr, offStr);
      // Fill selects
      var map = {year:"year", month:"month", day:"day", hour:"hour"};
      Object.keys(map).forEach(function(k){
        var s = document.getElementById(map[k]+"-stem");
        var b = document.getElementById(map[k]+"-branch");
        if(s && b){
          s.value = String(pillars[k].stemIdx);
          b.value = String(pillars[k].branchIdx);
        }
      });
      // Show readable and auto-calc
      var S = ["甲","乙","丙","丁","戊","己","庚","辛","壬","癸"];
      var B = ["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"];
      function fmt(p){ return S[p.stemIdx] + B[p.branchIdx]; }
      disp.innerHTML = "<div>Year: "+fmt(pillars.year)+"</div>"+
                       "<div>Month: "+fmt(pillars.month)+"</div>"+
                       "<div>Day: "+fmt(pillars.day)+"</div>"+
                       "<div>Hour: "+fmt(pillars.hour)+"</div>";
      // auto-click "Calculate" if present
      document.getElementById("calc-btn")?.click();
      // Scroll to results area
      document.getElementById("five-bars")?.scrollIntoView({behavior:"smooth", block:"center"});
    }catch(e){
      err.textContent = e.message || "Unknown error"; err.style.display = "block";
      console.error("Auto-Fill error:", e);
    }
  });
});
</script>

</body></html>
